---
title: Decred
sidebar_label: Decred
---

<img src="/blackbox/docs/assets/dcr.svg" style="width:60%;"/>

From the Decred [docs](https://docs.decred.org/)

> Decred (/ˈdi:ˈkred/, /dɪˈkred/, dee-cred) is a blockchain-based cryptocurrency with a strong focus on community input, open governance, and sustainable funding for development. It utilizes a hybrid Proof-of-Work (PoW) and Proof-of-Stake (PoS) mining system to ensure that a small group cannot dominate the flow of transactions or make changes to Decred without the input of the community. A unit of the currency is called a decred (DCR).

# Quickstart

## Config
`~/.blackbox/blackbox.yaml`

```yaml
version: '3.7'
services: 
  decred:
```

## Environment
```.env
DECRED_RPCUSER=satoshi
DECRED_RPCPASS=somethingstrong
DECRED_WALLET_PASSWORD=secretstuff
```

## Initialization

Decred has some very specific things it needs to get initialized that require manual intervention. When you first startup the stack, you will be prompted for input.

```shell
root@odroidc2:~# blackbox start
❯ Registering services in /var/lib/blackbox/services
❯ BLACKBOX starting ...
❯ Running prestart script for decred
[decred] Configuring Decred ...
[decred] Creating directory: /root/.blackbox/data/decred
[decred] Creating directory: /root/.blackbox/data/decred/dcrd
[decred] Creating directory: /root/.blackbox/data/decred/dcrwallet
[decred] Generating dcrd TLS certs
[decred] Generating dcrwallet TLS certs
[decred] ATTENTION: You need to create a wallet ...
... pulling the images ...
2019-07-26 15:18:26.960 [WRN] DCRW: open /home/decred/.dcrwallet/dcrwallet.conf: no such file or directory

Enter the private passphrase for your new wallet:
Confirm passphrase:

Do you want to add an additional layer of encryption for public data? (n/no/y/yes) [no]:
Do you have an existing wallet seed you want to use? (n/no/y/yes) [no]:
Your wallet generation seed is:
<a bunch of words>
Hex: <hex>
IMPORTANT: Keep the seed in a safe place as you
will NOT be able to restore your wallet without it.
Please keep in mind that anyone who has access
to the seed can also restore your wallet thereby
giving them access to all your funds, so it is
imperative that you keep it in a secure location.
Once you have stored the seed in a safe and secure location, enter "OK" to coOK nue: ≈
Creating the wallet...
2019-07-26 15:20:20.311 [INF] WLLT: Upgrading database from version 1 to 11
2019-07-26 15:20:28.959 [INF] WLLT: Opened wallet
The wallet has been created successfully.
[decred] ATTENTION: Your decred wallet has been successfully initialized!
[decred] ATTENTION: Add your wallet password to env var DECRED_WALLET_PASSWORD and restart.
```

## Recipe: Solo Voting

> This service requires manual setup


1. Add the following config to your `blackbox.yml`
  ```yaml
  version: "3.7"
  
  x-blackbox: 
    recipe: decred-solo-voting
  ```
1. Install the binary wrappers and start the service stack, following the prompts to manually create a wallet (if absent)

  ```shell
  blackboxd bin install dcrctl && \
  blackboxd start 
  ```
1. Generate a voting address  

  ```shell
  dcrctl --wallet getnewaddress
  ```
1. Add the following environment variables to `.env`

  ```.env
  DATA_DIR=
  DECRED_WALLET_PASSWORD=
  DECRED_VOTING_ADDRESS=
  ```
  
  * `DATA_DIR` defaults to `~/.blackbox/data`. Change this to suit.
  * `DECRED_WALLET_PASSWORD` is the password given during setup
  * `DECRED_VOTING_ADDRESS` is the address generated in the previous step
1. Finally, restart the service stack

  ```shell
  blackboxd start 
  ```

## General Usage

> This service requires manual setup



The `decred` service is composed of 2 individual services: `dcrd` and `dcrwallet`. These sub-services are not currently separable from the main `decred` service since they function together.

To use the recipe, configure your `blackbox.yml` file as follows:

```yaml
version: "3.7"

services: 
  decred:
```



Once you have specified the `decred` recipe, run `blackboxd start` and follow the prompts to initialize your wallet.
After this is done, you should be able to reliably boot `blackboxd` unattended.

## Environment Variables

When using the service, these environment variables are generated by `blackboxd` with reasonable defaults. You may override them in your shell or `.env` file.

```.env

# Once you setup the wallet by starting the system, the following should be set for unattended operation.
DECRED_WALLET_PASSWORD=
DECRED_VOTING_ADDRESS=
DECRED_EXTERNAL_IP=
```

You may `export` these in the shell before startup, or put them in a `.env` file at the root of the blackbox dir.

## Ports

See the [Decred docs](https://docs.decred.org/faq/configuration/) for more information.

### dcrd

https://docs.decred.org/wallets/cli/dcrd-and-dcrwallet-cli-arguments/

|              | Mainnet | Testnet | Simnet |
| ------------ | ------- | ------- | ------ |
| Peer to Peer | 9108    | 19108   | 18555  |
| RPC Server   | 9109    | 19109   | 19556  |

### dcrwallet

|          | Mainnet | Testnet | Simnet |
| -------- | ------- | ------- | ------ |
| JSON-RPC | 9110    | 19110   | 19557  |
| gRPC     | 9111    | 19111   | 19558  |

By default, these ports are not exposed. To open them, add the `ports` key to the config file.

```yaml
version: "3.7"

services:
  pivx:
    ports:
      - 9108:9108
      ...
```

## TLS Certs

Decred is pretty serious about security and verification in its communications. As such, it uses TLS certs for its RPC connections. The daemons generate their own certs if left alone, but the daemon generated certs are not compatible with this Docker network. This is due to the way that the domains are registered in the cert.

This project generates certs that can be used to get Decred working in its default case. This happens at service boot (see the prestart script). If you would like to heighten your own security, you may generate new certs manually.

[This article](https://stakey.club/en/digital-certificates-for-rpc-connections/) gives a nice tutorial.