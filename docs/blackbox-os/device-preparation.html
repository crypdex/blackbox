<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Device Preparation · BlackboxOS</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;This guide focuses on the preparation of ARM64-based Linux devices for the BlackboxOS, though it should also be relevant for x86 machines. If you know your way around a command line, it should be fairly straighforward.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Device Preparation · BlackboxOS"/><meta property="og:type" content="website"/><meta property="og:url" content="https://crypdex.io/blackbox/"/><meta property="og:description" content="&lt;p&gt;This guide focuses on the preparation of ARM64-based Linux devices for the BlackboxOS, though it should also be relevant for x86 machines. If you know your way around a command line, it should be fairly straighforward.&lt;/p&gt;
"/><meta property="og:image" content="https://crypdex.io/blackbox/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://crypdex.io/blackbox/img/docusaurus.png"/><link rel="shortcut icon" href="/blackbox/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/blackbox/css/main.css"/><script src="/blackbox/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/blackbox/"><img class="logo" src="/blackbox/img/logo.svg" alt="BlackboxOS"/><h2 class="headerTitleWithLogo">BlackboxOS</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/blackbox/docs/intro" target="_self">Docs</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Device Preparation</h1></header><article><div><span><p>This guide focuses on the preparation of ARM64-based Linux devices for the BlackboxOS, though it should also be relevant for x86 machines. If you know your way around a command line, it should be fairly straighforward.</p>
<p>In addition to some general Linux housekeeping and setup, you will be installing these things</p>
<ul>
<li>Docker</li>
<li>Docker Compose</li>
<li>Blackbox</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="the-basics"></a><a href="#the-basics" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Basics</h2>
<p>The following sequence is followed to prepare a device for delivery. It is assumed that you have a Linux OS installed and configured with enough RAM or swap. Armbian is a good place to start as it has zram already allocated.</p>
<h3><a class="anchor" aria-hidden="true" id="swap"></a><a href="#swap" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Swap</h3>
<p>Many SBCs do not have enough RAM to run blockchain applications reliably. Even boards with 2GB RAM still need some overhead to keep processes from running out of memory. Enabling a swap disk can prevent applications from running out of memory at the expense of performance and disk longevity since it will use the storage volume to offload the contents of RAM.</p>
<p>If you have an OS flashed that needs a swap disk setup, try this</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># Creates a swapfile and adds it to fstab</span>

fallocate -l 2G /swapfile &amp;&amp; \
chmod 600 /swapfile &amp;&amp; \
mkswap /swapfile &amp;&amp; \
swapon /swapfile &amp;&amp; \
<span class="hljs-built_in">echo</span> <span class="hljs-string">"/swapfile swap swap defaults 0 0"</span> &gt;&gt; /etc/fstab &amp;&amp; \
swapon --show
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="create-the-defaults"></a><a href="#create-the-defaults" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create the Defaults</h2>
<ul>
<li>Change the root password to <code>crypdex</code> default
<ul>
<li><code>passwd</code></li>
</ul></li>
<li>Change the hostname: <code>nano /etc/hostname</code></li>
<li>Create the default directory: <code>mkdir ~/.blackbox</code></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="software-installation"></a><a href="#software-installation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Software Installation</h2>
<h3><a class="anchor" aria-hidden="true" id="system-software"></a><a href="#system-software" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>System Software</h3>
<p>We need to install some required software in order to continue setup. Among the packages are:</p>
<ul>
<li>System utilties for monitoring</li>
<li>Avahi zeroconf libs for discoverability</li>
<li>Python build tooling for Docker Compose</li>
</ul>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># Install requirements</span>
apt update &amp;&amp; apt install -y \
<span class="hljs-comment"># APT tooling</span>
apt-transport-https ca-certificates curl gnupg-agent software-properties-common \
<span class="hljs-comment"># System utilities</span>
htop iotop bmon \
<span class="hljs-comment"># Zeroconf</span>
avahi-daemon avahi-discover avahi-utils libnss-mdns mdns-scan \
<span class="hljs-comment"># Needed to install Docker Compose</span>
python python-pip python-setuptools python-dev libffi-dev
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="apt-sources"></a><a href="#apt-sources" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>APT Sources</h3>
<p>We now need to add a couple of additional package sources so that APT can find all the software we need. These are added after the primary installations because they rely on software installed during that step.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-1-tab-2" class="nav-link active" data-group="group_1" data-tab="tab-group-1-content-2">arm64</div><div id="tab-group-1-tab-3" class="nav-link" data-group="group_1" data-tab="tab-group-1-content-3">x86_64</div></div><div class="tab-content"><div id="tab-group-1-content-2" class="tab-pane active" data-group="group_1" tabindex="-1"><div><span><pre><code class="hljs css language-bash"><span class="hljs-comment"># DOCKER (Debian)</span><br />curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - &amp;&amp; \<br />apt-key fingerprint 0EBFCD88 &amp;&amp; \<br />add-apt-repository \<br />   <span class="hljs-string">"deb [arch=arm64] https://download.docker.com/linux/debian \<br />   <span class="hljs-variable">$(lsb_release -cs)</span> \<br />   stable"</span> &amp;&amp; \<br /><span class="hljs-comment"># BLACKBOX</span><br /><span class="hljs-built_in">echo</span> <span class="hljs-string">"deb [trusted=yes] https://apt.fury.io/crypdex/ /"</span> &gt;&gt; /etc/apt/sources.list.d/fury.list<br /></code></pre>
</span></div></div><div id="tab-group-1-content-3" class="tab-pane" data-group="group_1" tabindex="-1"><div><span><pre><code class="hljs css language-bash"><span class="hljs-comment"># DOCKER (Debian)</span><br />curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - &amp;&amp; \<br />apt-key fingerprint 0EBFCD88 &amp;&amp; \<br />add-apt-repository \<br />   <span class="hljs-string">"deb [arch=arm64] https://download.docker.com/linux/debian \<br />   <span class="hljs-variable">$(lsb_release -cs)</span> \<br />   stable"</span> &amp;&amp; \<br /><span class="hljs-comment"># BLACKBOX</span><br /><span class="hljs-built_in">echo</span> <span class="hljs-string">"deb [trusted=yes] https://apt.fury.io/crypdex/ /"</span> &gt;&gt; /etc/apt/sources.list.d/fury.list<br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="install-packages"></a><a href="#install-packages" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Install Packages</h3>
<p>Finally we are ready to install the softare that runs Blackbox</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># Docker and Blacboxd</span>
apt update &amp;&amp; \
apt install -y docker-ce docker-ce-cli containerd.io blackboxd &amp;&amp; \
pip install wheel docker-compose
</code></pre>
<p>Now is a good time to</p>
<pre><code class="hljs css language-bash">reboot
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="mount-disk"></a><a href="#mount-disk" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mount Disk</h2>
<p>One strategy for maintaining system and data sanity is to keep the blockchain data on a separate disk from the operating system. This allows for smaller cloneable discs to be used to format the OS and isolates potential disk failures from affecting wallets and chaindata.</p>
<p>Digital Ocean has a great tutorial on this which I will link to rather than copy here.</p>
<p><a href="https://www.digitalocean.com/community/tutorials/how-to-partition-and-format-storage-devices-in-linux">https://www.digitalocean.com/community/tutorials/how-to-partition-and-format-storage-devices-in-linux</a></p>
<h2><a class="anchor" aria-hidden="true" id="seed-data"></a><a href="#seed-data" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Seed Data</h2>
<p>Dependent upon the speed of you system overall, you may choose to pre-seed your data. For small SBCs using eMMC or microSD cards (yikes) chain sync may take a very very long time.</p>
<p><code>blackboxd</code> expects that data is stored at <code>~/.blackbox/data/${service-name}</code>. You may change this using <code>DATA_DIR=</code> set in your shell or stored in <code>~/.env</code></p>
<h2><a class="anchor" aria-hidden="true" id="customer-delivery-considerations"></a><a href="#customer-delivery-considerations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Customer Delivery Considerations</h2>
<ul>
<li>Remove the Portainer directory
<ul>
<li><code>rm -rf ~/.blackbox/data/portainer</code></li>
</ul></li>
<li>Remove the blockchain conf (it will be regenerated)
<ul>
<li><code>rm -rf ~/.blackbox/data/pivx/pivx.conf</code></li>
</ul></li>
<li>Change the hostname to match the serial.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="platform-specific-notes"></a><a href="#platform-specific-notes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Platform Specific Notes</h2>
<h3><a class="anchor" aria-hidden="true" id="odroid-c2"></a><a href="#odroid-c2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Odroid C2</h3>
<ul>
<li>Install the <a href="https://wiki.odroid.com/odroid-c2/os_images/ubuntu/ubuntu">image</a> from Odroid. Armbian does not work as well.</li>
<li>Swap must be enabled.</li>
</ul>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#the-basics">The Basics</a><ul class="toc-headings"><li><a href="#swap">Swap</a></li></ul></li><li><a href="#create-the-defaults">Create the Defaults</a></li><li><a href="#software-installation">Software Installation</a><ul class="toc-headings"><li><a href="#system-software">System Software</a></li><li><a href="#apt-sources">APT Sources</a></li><li><a href="#install-packages">Install Packages</a></li></ul></li><li><a href="#mount-disk">Mount Disk</a></li><li><a href="#seed-data">Seed Data</a></li><li><a href="#customer-delivery-considerations">Customer Delivery Considerations</a></li><li><a href="#platform-specific-notes">Platform Specific Notes</a><ul class="toc-headings"><li><a href="#odroid-c2">Odroid C2</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="https://crypdex.io" class="nav-home"><img src="/blackbox/img/logo-full-white.png" alt="BlackboxOS"/></a><div><h5>Community</h5><a href="https://discord.gg/TjmNPth">Discord</a><a href="https://www.instagram.com/crypdex_io/" target="_blank" rel="noreferrer noopener">Instagram</a></div><div><h5>More</h5><a href="https://medium.com/crypdex" target="_blank" rel="noreferrer noopener">Medium</a><a href="https://github.com/crypdex/blackbox">GitHub</a><a class="github-button" href="https://github.com/crypdex/blackbox" data-icon="octicon-star" data-count-href="/crypdex/blackbox/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 Crypdex</section></footer></div></body></html>